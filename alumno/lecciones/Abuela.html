<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M√§zi metsu Fela - Lecci√≥n Interactiva</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Comic Sans MS", "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
            background: radial-gradient(circle at 30% 20%, #bef264 0%, #d9f99d 30%, #f7fee7 70%);
            animation: gradientShift 15s ease infinite;
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }

        @keyframes gradientShift {
            0% {
                background: radial-gradient(circle at 30% 20%, #bef264 0%, #d9f99d 30%, #f7fee7 70%);
            }
            33% {
                background: radial-gradient(circle at 70% 80%, #d9f99d 0%, #84cc16 40%, #ecfccb 80%);
            }
            66% {
                background: linear-gradient(135deg, #d9f99d 0%, #a3e635 50%, #bef264 100%);
            }
            100% {
                background: radial-gradient(circle at 30% 20%, #bef264 0%, #d9f99d 30%, #f7fee7 70%);
            }
        }

        @keyframes pulseGreen {
            0% {
                box-shadow: 0 6px 20px rgba(132, 204, 22, 0.5), 0 0 0 0 rgba(163, 230, 53, 0.7);
            }
            70% {
                box-shadow: 0 6px 20px rgba(132, 204, 22, 0.5), 0 0 0 15px rgba(163, 230, 53, 0);
            }
            100% {
                box-shadow: 0 6px 20px rgba(132, 204, 22, 0.5), 0 0 0 0 rgba(163, 230, 53, 0);
            }
        }

        @keyframes bounce {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-10px);
            }
        }

        @keyframes shake {
            0%, 100% {
                transform: translateX(0);
            }
            25% {
                transform: translateX(-10px);
            }
            75% {
                transform: translateX(10px);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes scaleIn {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 2px solid #84cc16;
            box-shadow: 0 10px 30px rgba(132, 204, 22, 0.2);
            overflow: hidden;
        }

        .section {
            display: none;
            padding: 40px;
            animation: fadeInUp 0.8s ease;
        }

        .section.active {
            display: block;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            border-bottom: 3px solid transparent;
            background: linear-gradient(white, white) padding-box, 
                        linear-gradient(90deg, transparent, #84cc16, transparent) border-box;
            padding-bottom: 20px;
        }

        .header h1 {
            font-size: 2.5em;
            color: #4d7c0f;
            text-shadow: 0 2px 4px rgba(77, 124, 15, 0.2);
            margin-bottom: 10px;
            animation: bounce 2s ease-in-out infinite;
        }

        .header h2 {
            font-size: 2em;
            color: #4d7c0f;
            margin-bottom: 15px;
        }

        .subtitle {
            font-size: 1.2em;
            color: #65a30d;
            font-style: italic;
        }

        .text-content {
            margin-bottom: 40px;
        }

        .paragraph {
            margin-bottom: 25px;
            padding: 15px;
            background: rgba(217, 249, 157, 0.3);
            border-radius: 12px;
            border-left: 4px solid #84cc16;
            transition: transform 0.3s ease;
        }

        .paragraph:hover {
            transform: translateX(5px);
        }

        .otomi-text {
            display: inline-block;
            cursor: help;
            font-size: 1.1em;
            color: #4d7c0f;
            padding: 0.4rem 0.8rem;
            margin: 0.2rem;
            border-radius: 8px;
            background: rgba(190, 242, 100, 0.3);
            transition: all 0.3s ease;
            position: relative;
        }

        .otomi-text:hover {
            background: rgba(132, 204, 22, 0.5);
            transform: scale(1.02);
            box-shadow: 0 4px 12px rgba(132, 204, 22, 0.3);
            color: #3f6212;
        }

        .tooltip {
            position: fixed;
            background: #4d7c0f;
            color: white;
            padding: 12px 16px;
            border-radius: 10px;
            font-size: 0.95em;
            max-width: 400px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s ease;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(77, 124, 15, 0.5);
        }

        .tooltip.show {
            opacity: 1;
            animation: fadeIn 0.2s ease;
        }

        .primary-button {
            background: linear-gradient(135deg, #84cc16, #65a30d);
            color: white;
            border: none;
            padding: 1rem 2.5rem;
            font-size: 1.1em;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 0 auto;
            font-weight: bold;
            box-shadow: 0 6px 20px rgba(132, 204, 22, 0.5);
            animation: pulseGreen 2s infinite;
            position: relative;
        }

        .primary-button:hover {
            background: linear-gradient(135deg, #65a30d, #4d7c0f);
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 10px 25px rgba(132, 204, 22, 0.7);
            animation: none;
        }

        .primary-button:active {
            transform: translateY(-1px) scale(1.02);
        }

        .primary-button::after {
            content: " ‚Üí";
            display: inline-block;
            transition: transform 0.3s ease;
        }

        .primary-button:hover::after {
            transform: translateX(5px);
        }

        .lives {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 1.5em;
            margin-top: 15px;
            background: rgba(255, 255, 255, 0.8);
            padding: 0.8rem 1.5rem;
            border-radius: 50px;
            border: 2px solid #bef264;
        }

        #hearts {
            font-size: 1.8em;
        }

        #lives-text {
            font-size: 0.7em;
            color: #65a30d;
            font-weight: bold;
        }

        .exercise-content {
            max-width: 600px;
            margin: 0 auto;
            animation: slideInRight 0.7s ease;
        }

        .progress {
            text-align: center;
            margin-bottom: 30px;
            font-size: 1.2em;
            color: #4d7c0f;
            font-weight: 600;
            background: rgba(190, 242, 100, 0.3);
            padding: 1rem;
            border-radius: 15px;
            border: 2px dashed #84cc16;
        }

        .question-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(8px);
            padding: 30px;
            border-radius: 20px;
            border: 2px dashed #65a30d;
            box-shadow: 0 15px 40px rgba(132, 204, 22, 0.2);
            animation: fadeIn 0.5s ease;
        }

        .instruction {
            font-size: 1.1em;
            color: #65a30d;
            margin-bottom: 20px;
            text-align: center;
            font-weight: bold;
        }

        .question-text {
            font-size: 1.3em;
            color: #4d7c0f;
            margin-bottom: 25px;
            padding: 20px;
            background: rgba(217, 249, 157, 0.3);
            border: 1px solid #bef264;
            border-radius: 12px;
            text-align: center;
            line-height: 1.8;
        }

        .answer-input {
            width: 100%;
            padding: 0.8rem 1.2rem;
            font-size: 1.1em;
            border: 2px solid #84cc16;
            border-radius: 10px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
            background: white;
        }

        .answer-input:focus {
            outline: none;
            border-color: #4d7c0f;
            box-shadow: 0 0 0 3px rgba(132, 204, 22, 0.3);
        }

        .feedback {
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            font-weight: 600;
            font-size: 1.1em;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .feedback.show {
            opacity: 1;
        }

        .feedback.correct {
            background: rgba(190, 242, 100, 0.6);
            color: #4d7c0f;
            border: 2px solid #84cc16;
            animation: bounce 0.5s ease;
        }

        .feedback.correct::before {
            content: "üå± ";
        }

        .feedback.incorrect {
            background: rgba(254, 202, 202, 0.3);
            color: #991b1b;
            border: 2px solid #fca5a5;
            animation: shake 0.5s ease;
        }

        .feedback.incorrect::before {
            content: "üçÇ ";
        }

        .result-content {
            min-height: 400px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .result-card {
            text-align: center;
            display: none;
        }

        .result-card.active {
            display: block;
            animation: scaleIn 0.5s ease;
        }

        .success-icon, .failure-icon {
            font-size: 5em;
            margin-bottom: 20px;
            animation: bounce 1s ease infinite;
        }

        .result-card h2 {
            color: #4d7c0f;
            margin-bottom: 20px;
            font-size: 2em;
        }

        .result-card p {
            color: #65a30d;
            font-size: 1.2em;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        #success-result.active {
            background: linear-gradient(135deg, rgba(217, 249, 157, 0.4), rgba(190, 242, 100, 0.4));
            padding: 3rem;
            border-radius: 20px;
            border: 3px solid #84cc16;
        }

        @media (max-width: 768px) {
            .section {
                padding: 20px;
            }

            .header h1 {
                font-size: 2em;
            }

            .otomi-text {
                font-size: 1em;
            }

            .question-text {
                font-size: 1.1em;
            }

            .tooltip {
                max-width: 90vw;
                font-size: 0.9em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Secci√≥n de Lectura -->
        <section id="reading-section" class="section active">
            <div class="header">
                <h1>M√§zi metsu Fela</h1>
                <p class="subtitle">Mi abuelita Fela</p>
            </div>

            <div class="text-content">
                <div class="paragraph">
                    <span class="otomi-text" data-translation="Mi abuelita se llama Rafaela, pero todos le dicen Fela, a mi me dec√≠a como era antes, de como com√≠an.">
                        M√§zi metsu ge rƒÅ th√º√ºh√º Rafaela, gaÃ±tho y√§ j√§√≠ √´mbi Fela, 'i xiki ha nja nu'buÃ± m√§ yabuÃ±, ha mi nja yƒÅ nts'hm√´.
                    </span>
                </div>

                <div class="paragraph">
                    <span class="otomi-text" data-translation="Mi abuela dice que antes no compraban comida, que ten√≠an que poner su nixtamal, tambi√©n ten√≠an que cosechar su comida como el ma√≠z, el frijol, calabaza, papa, cilantro y varias cosas m√°s, para hacer las tortillas.">
                        Ma zi metsu 'i xiki ge nubuÃ± m√§ ya'buÃ± hinmi taÃ±y ya nts'ihm√´, 'n√´ mi hoÃ±ts'e ya sun√≠, 'ne mi t√ºh√º gaÃ±tho y√§ nts'ihme teng√º r√§ deÃ±th√§, r√§ juÃ±, r√§ nts'uÃ±m√º, r√§ buk'√º√§, r√§ nandru, 'n√´ mi ra y√§ k'an√≠.
                    </span>
                </div>

                <div class="paragraph">
                    <span class="otomi-text" data-translation="Ocupaban un metate (el metate est√° hecho de piedra) antes no hab√≠a molino, todo se hac√≠a en casa, no hab√≠an cosas procesadas.">
                        Pa ya hme mi kuÃ±n√≠ ra s√ºn√≠ ko r√§ njuÃ±n√≠ do 'ne r√° 'yeÃ±'yu, hinte mi ja r√§ njoÃ±ni t'eÃ±gi, gatho mi pa nt'oÃ±t'√© nubuÃ± ja r√§ ng√º.
                    </span>
                </div>

                <div class="paragraph">
                    <span class="otomi-text" data-translation="Para preparar la comida ten√≠an que poner lumbre.">
                        Hinte mi ja y√§ nts'ihme m√§ hoki.
                    </span>
                </div>

                <div class="paragraph">
                    <span class="otomi-text" data-translation="Y si en casa no ten√≠an le√±a o algo que sirviera para que la lumbre o el fuego prendiera, ten√≠an que salir a buscar la le√±a al cerro. Y era un poco tardado hacer tu comida, ten√≠as que empezar en la ma√±ana para que tu comida estuviera lista para la hora de la comida.">
                        Pa ge da nt'oÃ±t'√© r√§ nts'ihme mi pa nts'oke r√§ tsib√≠ ko r√§ za. Nu buÃ± hinte mi ja r√§ za, mi xuÃ± y√§ j√§√≠ n√ºbuÃ± ja r√§ t'oÃ±hoÃ±. Mi ya'√§ pa da nhogi ra tuÃ±huÃ±, mi Fud√≠ x√ºdi thoho pa xt√≠ nhogi nu'buÃ± bi zoÃ±ni ra ora ge di ntsihm√´ y√§ j√§√≠.
                    </span>
                </div>
            </div>

            <button id="start-exercise-btn" class="primary-button">Comenzar ejercicio</button>
        </section>

        <!-- Secci√≥n de Ejercicio -->
        <section id="exercise-section" class="section">
            <div class="header">
                <h2>Ejercicio: Completa las frases</h2>
                <div class="lives">
                    <span id="hearts">‚ù§Ô∏è‚ù§Ô∏è</span>
                    <span id="lives-text">2 vidas</span>
                </div>
            </div>

            <div class="exercise-content">
                <div class="progress">
                    <p>Frases completadas: <span id="completed-count">0</span>/5</p>
                </div>

                <div class="question-card">
                    <p class="instruction">Escribe la palabra que falta en otom√≠:</p>
                    <p id="question-text" class="question-text"></p>
                    <input type="text" id="answer-input" class="answer-input" placeholder="Escribe aqu√≠...">
                    <button id="check-btn" class="primary-button">Verificar</button>
                    <div id="feedback" class="feedback"></div>
                </div>
            </div>
        </section>

        <!-- Secci√≥n de Resultado Final -->
        <section id="result-section" class="section">
            <div class="result-content">
                <div id="success-result" class="result-card">
                    <div class="success-icon">‚úÖ</div>
                    <h2>Lecci√≥n completada con √©xito</h2>
                    <p>Has aprendido palabras clave en otom√≠ sobre las tradiciones de la abuela Fela.</p>
                    <button id="back-to-reading-btn" class="primary-button">Volver a la lectura</button>
                </div>

                <div id="failure-result" class="result-card">
                    <div class="failure-icon">üòî</div>
                    <h2>Lecci√≥n terminada</h2>
                    <p>Intenta nuevamente</p>
                    <button id="restart-btn" class="primary-button">Reiniciar</button>
                </div>
            </div>
        </section>

        <!-- Tooltip para hover -->
        <div id="tooltip" class="tooltip"></div>
    </div>

    <script>
        // Estado del juego
        const gameState = {
            lives: 2,
            completedCount: 0,
            usedQuestions: new Set(),
            currentQuestion: null,
        }

        // Banco de preguntas
        const questionBank = [
            { text: "M√§zi metsu ge rƒÅ th√º√ºh√º Rafaela, gaÃ±tho y√§ j√§√≠ √´mbi _____.", answer: "Fela" },
            { text: "'i xiki ha nja nu'buÃ± m√§ _____.", answer: "yabuÃ±" },
            { text: "'n√´ mi hoÃ±ts'e ya _____.", answer: "sun√≠" },
            { text: "r√§ nts'ihme teng√º r√§ deÃ±th√§, r√§ juÃ±, r√§ nts'uÃ±m√º, r√§ _____, r√§ nandru.", answer: "buk'√º√§" },
            { text: "Pa ya hme mi kuÃ±n√≠ ra s√ºn√≠ ko r√§ njuÃ±n√≠ do 'ne r√° _____.", answer: "'yeÃ±'yu" },
            { text: "hinte mi ja r√§ njoÃ±ni _____.", answer: "t'eÃ±gi" },
            { text: "gatho mi pa nt'oÃ±t'√© nubuÃ± ja r√§ _____.", answer: "ng√º" },
            { text: "Hinte mi ja y√§ nts'ihme m√§ _____.", answer: "hoki" },
            { text: "Pa ge da nt'oÃ±t'√© r√§ nts'ihme mi pa nts'oke r√§ tsib√≠ ko r√§ _____.", answer: "za" },
            { text: "Nu buÃ± hinte mi ja r√§ za, mi xuÃ± y√§ j√§√≠ n√ºbuÃ± ja r√§ _____.", answer: "t'oÃ±hoÃ±" },
        ]

        // Elementos del DOM
        const readingSection = document.getElementById("reading-section")
        const exerciseSection = document.getElementById("exercise-section")
        const resultSection = document.getElementById("result-section")
        const startExerciseBtn = document.getElementById("start-exercise-btn")
        const checkBtn = document.getElementById("check-btn")
        const answerInput = document.getElementById("answer-input")
        const questionText = document.getElementById("question-text")
        const feedback = document.getElementById("feedback")
        const completedCountEl = document.getElementById("completed-count")
        const heartsEl = document.getElementById("hearts")
        const livesTextEl = document.getElementById("lives-text")
        const successResult = document.getElementById("success-result")
        const failureResult = document.getElementById("failure-result")
        const backToReadingBtn = document.getElementById("back-to-reading-btn")
        const restartBtn = document.getElementById("restart-btn")
        const tooltip = document.getElementById("tooltip")

        // Funcionalidad de hover para traducciones
        document.querySelectorAll(".otomi-text").forEach((element) => {
            element.addEventListener("mouseenter", (e) => {
                const translation = e.target.getAttribute("data-translation")
                tooltip.textContent = translation
                tooltip.classList.add("show")
                updateTooltipPosition(e)
            })

            element.addEventListener("mousemove", (e) => {
                updateTooltipPosition(e)
            })

            element.addEventListener("mouseleave", () => {
                tooltip.classList.remove("show")
            })
        })

        function updateTooltipPosition(e) {
            const x = e.clientX
            const y = e.clientY
            tooltip.style.left = x + 15 + "px"
            tooltip.style.top = y + 15 + "px"
        }

        // Iniciar ejercicio
        startExerciseBtn.addEventListener("click", () => {
            readingSection.classList.remove("active")
            exerciseSection.classList.add("active")
            resetGame()
            loadNewQuestion()
        })

        // Verificar respuesta
        checkBtn.addEventListener("click", checkAnswer)
        answerInput.addEventListener("keypress", (e) => {
            if (e.key === "Enter") {
                checkAnswer()
            }
        })

        function resetGame() {
            gameState.lives = 2
            gameState.completedCount = 0
            gameState.usedQuestions = new Set()
            updateUI()
        }

        function loadNewQuestion() {
            // Obtener preguntas disponibles
            const availableQuestions = questionBank.filter((_, index) => !gameState.usedQuestions.has(index))

            if (availableQuestions.length === 0) {
                gameState.usedQuestions.clear()
                loadNewQuestion()
                return
            }

            // Seleccionar pregunta aleatoria
            const randomIndex = Math.floor(Math.random() * availableQuestions.length)
            const selectedQuestion = availableQuestions[randomIndex]

            // Encontrar el √≠ndice original
            const originalIndex = questionBank.findIndex((q) => q === selectedQuestion)
            gameState.usedQuestions.add(originalIndex)
            gameState.currentQuestion = selectedQuestion

            // Mostrar pregunta
            questionText.textContent = selectedQuestion.text
            answerInput.value = ""
            answerInput.disabled = false
            checkBtn.disabled = false
            feedback.classList.remove("show", "correct", "incorrect")
            feedback.textContent = ""
        }

        function checkAnswer() {
            const userAnswer = answerInput.value.trim()
            const correctAnswer = gameState.currentQuestion.answer

            if (!userAnswer) {
                return
            }

            answerInput.disabled = true
            checkBtn.disabled = true

            if (userAnswer === correctAnswer) {
                // Respuesta correcta
                gameState.completedCount++
                updateUI()

                feedback.textContent = "¬°Correcto!"
                feedback.classList.add("show", "correct")

                setTimeout(() => {
                    if (gameState.completedCount >= 5) {
                        showSuccessScreen()
                    } else {
                        loadNewQuestion()
                    }
                }, 1000)
            } else {
                // Respuesta incorrecta
                gameState.lives--
                updateUI()

                feedback.textContent = "Incorrecto, pierdes una vida"
                feedback.classList.add("show", "incorrect")

                setTimeout(() => {
                    if (gameState.lives <= 0) {
                        showFailureScreen()
                    } else {
                        loadNewQuestion()
                    }
                }, 1500)
            }
        }

        function updateUI() {
            completedCountEl.textContent = gameState.completedCount

            // Actualizar corazones
            const hearts = "‚ù§Ô∏è".repeat(gameState.lives) + "ü§ç".repeat(2 - gameState.lives)
            heartsEl.textContent = hearts
            livesTextEl.textContent = `${gameState.lives} vida${gameState.lives !== 1 ? "s" : ""}`
        }

        function showSuccessScreen() {
            exerciseSection.classList.remove("active")
            resultSection.classList.add("active")
            successResult.classList.add("active")
            failureResult.classList.remove("active")
        }

        function showFailureScreen() {
            exerciseSection.classList.remove("active")
            resultSection.classList.add("active")
            failureResult.classList.add("active")
            successResult.classList.remove("active")
        }

        // Volver a la lectura
        backToReadingBtn.addEventListener("click", () => {
            resultSection.classList.remove("active")
            readingSection.classList.add("active")
        })

        // Reiniciar
        restartBtn.addEventListener("click", () => {
            resultSection.classList.remove("active")
            exerciseSection.classList.add("active")
            resetGame()
            loadNewQuestion()
        })
    </script>
</body>
</html>
