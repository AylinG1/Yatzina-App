<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lección de Lectura - Hñahñu</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Fredoka', sans-serif;
        }
        .word-tooltip {
            position: relative;
            cursor: help;
            padding: 2px 4px;
            border-radius: 4px;
            transition: background-color 0.2s ease;
        }
        .word-tooltip:hover {
            background-color: rgba(147, 51, 234, 0.1);
        }
        .tooltip-text {
            visibility: hidden;
            opacity: 0;
            position: absolute;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 8px 12px;
            border-radius: 8px;
            white-space: nowrap;
            z-index: 1000;
            font-size: 0.9em;
            transition: opacity 0.3s ease, visibility 0.3s ease;
            pointer-events: none;
        }
        .tooltip-text::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 6px solid transparent;
            border-top-color: rgba(0, 0, 0, 0.9);
        }
        .word-tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }
        .quiz-option {
            transition: all 0.3s ease;
        }
        .quiz-option:hover:not(:disabled) {
            transform: translateX(8px);
        }
        .quiz-option.correct {
            animation: correctPulse 0.5s ease;
        }
        .quiz-option.incorrect {
            animation: shake 0.5s ease;
        }
        @keyframes correctPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 min-h-screen">
    <!-- Header -->
    <header class="text-center py-8 px-4">
        <a href="index.html" class="inline-block mb-4 text-purple-600 hover:text-purple-800 font-semibold">← Volver al Abecedario</a>
        <h1 class="text-4xl md:text-5xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-600 via-pink-600 to-orange-500 mb-2">
            Lección de Lectura
        </h1>
        <p class="text-lg md:text-xl text-gray-600">Pasa el mouse sobre las palabras para ver la traducción</p>
    </header>

    <!-- Reading Section -->
    <main class="container mx-auto px-4 pb-12 max-w-4xl">
        <!-- Story Card -->
        <div class="bg-white rounded-3xl shadow-xl p-6 md:p-10 mb-8">
            <h2 class="text-3xl font-bold text-purple-700 mb-6 text-center">La Tortilla de Tilo</h2>
            
            <div class="space-y-4 text-lg md:text-xl leading-relaxed text-gray-800">
                <p>
                    <span class="word-tooltip">—¿Ha hingi ma ra ngo, tio?
                        <span class="tooltip-text">—¿Ya comiste tu tortilla, tío?</span>
                    </span>
                    <span class="word-tooltip">—enga ra Tilo.
                        <span class="tooltip-text">—dice Tilo.</span>
                    </span>
                </p>

                <p>
                    <span class="word-tooltip">—Hina, hinga ma,
                        <span class="tooltip-text">—Sí, ya comí,</span>
                    </span>
                    <span class="word-tooltip">nge'ä jo'o to'o da su ra ngu,
                        <span class="tooltip-text">pero todavía está caliente la tuya,</span>
                    </span>
                    <span class="word-tooltip">—bi dädi rá tio.
                        <span class="tooltip-text">—le contesta el tío.</span>
                    </span>
                </p>

                <p>
                    <span class="word-tooltip">—Nu'i grí mage, tio.
                        <span class="tooltip-text">—No importa, tío.</span>
                    </span>
                    <span class="word-tooltip">Nuga ga kohiwa ga su ra ngu.
                        <span class="tooltip-text">Así se enfría la tuya.</span>
                    </span>
                </p>

                <p>
                    <span class="word-tooltip">Pe wa egagi ya ugi,
                        <span class="tooltip-text">Dámela entonces,</span>
                    </span>
                    <span class="word-tooltip">—enga ra Tilo.
                        <span class="tooltip-text">—dice Tilo.</span>
                    </span>
                </p>

                <p>
                    <span class="word-tooltip">Ha nurá tio bi ma ra ngo,
                        <span class="tooltip-text">Y el tío le da su tortilla,</span>
                    </span>
                    <span class="word-tooltip">ha ba kohi,
                        <span class="tooltip-text">ya fría,</span>
                    </span>
                    <span class="word-tooltip">asta rá datmani ba pengi ha rá ngu,
                        <span class="tooltip-text">hasta que termina de comer la suya,</span>
                    </span>
                    <span class="word-tooltip">ba hä ya ugi pa ra Tilo.
                        <span class="tooltip-text">y se la pasa a Tilo.</span>
                    </span>
                </p>

                <p>
                    <span class="word-tooltip">—Jamädi, tio
                        <span class="tooltip-text">—Gracias, tío</span>
                    </span>
                    <span class="word-tooltip">—enga ra Tilo—.
                        <span class="tooltip-text">—dice Tilo—.</span>
                    </span>
                    <span class="word-tooltip">¿Hangu di tu'a'i?
                        <span class="tooltip-text">¿Dónde está tu agua?</span>
                    </span>
                </p>

                <p>
                    <span class="word-tooltip">—Hinte gí tuki.
                        <span class="tooltip-text">—Allá está.</span>
                    </span>
                    <span class="word-tooltip">Nuga go dí tu'a'i
                        <span class="tooltip-text">Así está tu agua</span>
                    </span>
                    <span class="word-tooltip">nge'ä gá su ra ngu
                        <span class="tooltip-text">pero está tu tortilla</span>
                    </span>
                    <span class="word-tooltip">—bi dädi rá tio.
                        <span class="tooltip-text">—le contesta el tío.</span>
                    </span>
                </p>
            </div>
        </div>

        <!-- Quiz Section -->
        <div class="bg-gradient-to-br from-purple-100 to-pink-100 rounded-3xl shadow-xl p-6 md:p-10">
            <h2 class="text-3xl font-bold text-purple-700 mb-6 text-center">Completa las Frases</h2>
            <p class="text-gray-600 text-center mb-8">Selecciona la respuesta correcta según la lectura</p>
            
            <div id="quiz-container" class="space-y-6">
                <!-- Questions will be generated dynamically -->
            </div>

            <!-- Score Display -->
            <div id="score-display" class="mt-8 text-center hidden">
                <div class="bg-white rounded-2xl p-6 shadow-lg">
                    <h3 class="text-2xl font-bold text-purple-700 mb-2" id="score-title">¡Excelente trabajo!</h3>
                    <p class="text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-pink-600" id="score-text"></p>
                    <p class="text-gray-600 mt-2" id="score-message"></p>
                    <button onclick="resetQuiz()" class="mt-4 px-6 py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white font-semibold rounded-xl hover:from-purple-600 hover:to-pink-600 transition-all">
                        Intentar de nuevo
                    </button>
                </div>
            </div>
        </div>
    </main>

    <script>
        const questionBank = [
            // Grupo 1: Sobre la pregunta inicial de Tilo
            {
                group: 1,
                questions: [
                    {
                        question: "¿Qué le pregunta Tilo a su tío?",
                        options: ["¿Dónde está el agua?", "¿Ya comiste tu tortilla?", "¿Tienes hambre?"],
                        correct: 1
                    },
                    {
                        question: "¿Cuál es la primera pregunta que hace Tilo?",
                        options: ["¿Ya terminaste de comer tu tortilla, tío?", "¿Tienes agua, tío?", "¿Quieres más comida?"],
                        correct: 0
                    },
                    {
                        question: "Al inicio de la historia, ¿qué quiere saber Tilo?",
                        options: ["Si el tío tiene sed", "Si el tío ya comió su tortilla", "Si hay más tortillas"],
                        correct: 1
                    }
                ]
            },
            // Grupo 2: Sobre la tortilla caliente
            {
                group: 2,
                questions: [
                    {
                        question: "¿Por qué el tío le da su tortilla a Tilo?",
                        options: ["Porque no tiene hambre", "Porque la de Tilo todavía está caliente", "Porque tiene dos tortillas"],
                        correct: 1
                    },
                    {
                        question: "¿Cuál es el problema con la tortilla de Tilo?",
                        options: ["Está muy pequeña", "Está todavía muy caliente", "Está quemada"],
                        correct: 1
                    },
                    {
                        question: "¿Qué dice el tío sobre la tortilla de Tilo?",
                        options: ["Que está fría", "Que todavía está caliente", "Que está deliciosa"],
                        correct: 1
                    }
                ]
            },
            // Grupo 3: Sobre la respuesta de Tilo
            {
                group: 3,
                questions: [
                    {
                        question: "¿Qué dice Tilo sobre la tortilla caliente?",
                        options: ["Que no la quiere", "Que no importa, así se enfría", "Que espere a que se enfríe"],
                        correct: 1
                    },
                    {
                        question: "¿Cómo reacciona Tilo cuando le dicen que su tortilla está caliente?",
                        options: ["Dice que no importa, que así se enfría", "Se molesta", "Pide otra tortilla"],
                        correct: 0
                    },
                    {
                        question: "¿Qué solución propone Tilo para el problema de la tortilla caliente?",
                        options: ["Esperar un rato", "Que se enfríe mientras come la del tío", "Ponerle agua"],
                        correct: 1
                    }
                ]
            },
            // Grupo 4: Sobre el intercambio
            {
                group: 4,
                questions: [
                    {
                        question: "¿Qué le pide Tilo al tío después de recibir la tortilla?",
                        options: ["Más tortillas", "Su agua", "Sal para la comida"],
                        correct: 1
                    },
                    {
                        question: "¿Qué busca Tilo después del intercambio de tortillas?",
                        options: ["El agua del tío", "Más comida", "Una servilleta"],
                        correct: 0
                    },
                    {
                        question: "Al final, ¿qué necesita Tilo además de la tortilla?",
                        options: ["Salsa", "Agua", "Sal"],
                        correct: 1
                    }
                ]
            },
            // Grupo 5: Sobre vocabulario hñahñu
            {
                group: 5,
                questions: [
                    {
                        question: "¿Qué palabra en hñahñu significa 'gracias'?",
                        options: ["Hina", "Jamädi", "Nuga"],
                        correct: 1
                    },
                    {
                        question: "¿Cómo se dice 'gracias' en la lengua hñahñu?",
                        options: ["Jamädi", "Enga", "Dädi"],
                        correct: 0
                    },
                    {
                        question: "Cuando Tilo quiere agradecer, ¿qué palabra usa?",
                        options: ["Hinte", "Jamädi", "Hangu"],
                        correct: 1
                    }
                ]
            },
            // Grupo 6: Sobre la acción del tío
            {
                group: 6,
                questions: [
                    {
                        question: "¿Qué hace el tío cuando Tilo acepta comer su tortilla?",
                        options: ["Se la da inmediatamente", "Espera a terminar la suya primero", "Le da las dos tortillas"],
                        correct: 1
                    },
                    {
                        question: "¿Cuándo le pasa el tío su tortilla a Tilo?",
                        options: ["Antes de empezar a comer", "Después de terminar la suya", "A la mitad de su comida"],
                        correct: 1
                    },
                    {
                        question: "El tío termina de comer su tortilla y luego...",
                        options: ["Se va", "Se la pasa a Tilo", "Pide más comida"],
                        correct: 1
                    }
                ]
            },
            // Grupo 7: Sobre el estado de las tortillas
            {
                group: 7,
                questions: [
                    {
                        question: "¿En qué estado está la tortilla del tío cuando se la da a Tilo?",
                        options: ["Caliente", "Fría", "Tibia"],
                        correct: 1
                    },
                    {
                        question: "La tortilla que come Tilo primero está...",
                        options: ["Ya fría", "Recién hecha", "A medio comer"],
                        correct: 0
                    },
                    {
                        question: "¿Cómo describe el texto la tortilla del tío?",
                        options: ["Caliente", "Kohi (fría)", "Grande"],
                        correct: 1
                    }
                ]
            },
            // Grupo 8: Comprensión de la conversación
            {
                group: 8,
                questions: [
                    {
                        question: "¿Quién inicia la conversación en la historia?",
                        options: ["El tío", "Tilo", "Un narrador"],
                        correct: 1
                    },
                    {
                        question: "¿Cuántas personas conversan en esta historia?",
                        options: ["Una", "Dos: Tilo y su tío", "Tres"],
                        correct: 1
                    },
                    {
                        question: "La historia es un diálogo entre...",
                        options: ["Dos amigos", "Tilo y su tío", "Padre e hijo"],
                        correct: 1
                    }
                ]
            }
        ];

        let score = 0;
        let answeredQuestions = new Set();
        let totalQuestions = 5;
        let currentQuestions = [];

        function selectRandomQuestions() {
            currentQuestions = [];
            const usedGroups = new Set();
            
            // Seleccionar 5 preguntas de grupos diferentes
            while (currentQuestions.length < totalQuestions && usedGroups.size < questionBank.length) {
                const randomGroupIndex = Math.floor(Math.random() * questionBank.length);
                
                if (!usedGroups.has(randomGroupIndex)) {
                    const group = questionBank[randomGroupIndex];
                    const randomQuestionIndex = Math.floor(Math.random() * group.questions.length);
                    currentQuestions.push(group.questions[randomQuestionIndex]);
                    usedGroups.add(randomGroupIndex);
                }
            }
            
            return currentQuestions;
        }

        function renderQuiz() {
            const quizContainer = document.getElementById('quiz-container');
            quizContainer.innerHTML = '';
            
            currentQuestions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'bg-white rounded-2xl p-6 shadow-md';
                questionDiv.dataset.question = index;
                
                let optionsHTML = '';
                q.options.forEach((option, optIndex) => {
                    const isCorrect = optIndex === q.correct;
                    optionsHTML += `
                        <button class="quiz-option w-full text-left p-4 rounded-xl bg-purple-50 hover:bg-purple-100 border-2 border-purple-200" 
                                data-answer="${isCorrect ? 'correct' : 'wrong'}">
                            ${option}
                        </button>
                    `;
                });
                
                questionDiv.innerHTML = `
                    <p class="text-xl font-semibold text-gray-800 mb-4">${index + 1}. ${q.question}</p>
                    <div class="space-y-3">
                        ${optionsHTML}
                    </div>
                `;
                
                quizContainer.appendChild(questionDiv);
            });
            
            // Agregar event listeners a los nuevos botones
            attachQuizListeners();
        }

        function attachQuizListeners() {
            document.querySelectorAll('.quiz-option').forEach(button => {
                button.addEventListener('click', function() {
                    const questionDiv = this.closest('[data-question]');
                    const questionNumber = questionDiv.dataset.question;
                    
                    if (answeredQuestions.has(questionNumber)) {
                        return;
                    }

                    const isCorrect = this.dataset.answer === 'correct';
                    const allButtons = questionDiv.querySelectorAll('.quiz-option');

                    allButtons.forEach(btn => {
                        btn.disabled = true;
                        btn.classList.remove('hover:bg-purple-100');
                    });

                    if (isCorrect) {
                        this.classList.add('correct', 'bg-green-100', 'border-green-500');
                        this.innerHTML = this.textContent + ' ✓';
                        score++;
                    } else {
                        this.classList.add('incorrect', 'bg-red-100', 'border-red-500');
                        this.innerHTML = this.textContent + ' ✗';
                        allButtons.forEach(btn => {
                            if (btn.dataset.answer === 'correct') {
                                btn.classList.add('bg-green-100', 'border-green-500');
                                btn.innerHTML = btn.textContent + ' ✓';
                            }
                        });
                    }

                    answeredQuestions.add(questionNumber);

                    if (answeredQuestions.size === totalQuestions) {
                        setTimeout(showScore, 500);
                    }
                });
            });
        }

        function showScore() {
            const scoreDisplay = document.getElementById('score-display');
            const scoreText = document.getElementById('score-text');
            const scoreTitle = document.getElementById('score-title');
            const scoreMessage = document.getElementById('score-message');
            
            const percentage = (score / totalQuestions) * 100;
            
            scoreText.textContent = `Tu puntuación: ${score} de ${totalQuestions}`;
            
            // Mostrar diferentes mensajes según el puntaje
            if (percentage === 100) {
                scoreTitle.textContent = '¡Perfecto!';
                scoreMessage.textContent = '¡Excelente! Respondiste todas las preguntas correctamente.';
            } else if (percentage >= 80) {
                scoreTitle.textContent = '¡Muy bien!';
                scoreMessage.textContent = '¡Buen trabajo! Comprendidaste muy bien la lectura.';
            } else if (percentage >= 60) {
                scoreTitle.textContent = '¡Bien hecho!';
                scoreMessage.textContent = 'Lo hiciste bien. Intenta de nuevo para mejorar tu puntuación.';
            } else {
                scoreTitle.textContent = '¡Sigue intentando!';
                scoreMessage.textContent = 'Lee la historia nuevamente y vuelve a intentarlo. ¡Puedes mejorar!';
            }
            
            scoreDisplay.classList.remove('hidden');
            scoreDisplay.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        function resetQuiz() {
            score = 0;
            answeredQuestions.clear();
            
            // Hide score display
            document.getElementById('score-display').classList.add('hidden');
            
            // Generate new random questions
            selectRandomQuestions();
            renderQuiz();
            
            // Scroll to top of quiz
            document.getElementById('quiz-container').scrollIntoView({ behavior: 'smooth' });
        }

        // Initialize quiz on page load
        window.addEventListener('DOMContentLoaded', function() {
            selectRandomQuestions();
            renderQuiz();
        });
    </script>
</body>
</html>